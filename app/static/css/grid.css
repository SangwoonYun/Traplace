/* File: app/static/css/grid.css */

/* ---------------------------------------------
 * Grid (main one-cell spacing lines)
 * ------------------------------------------- */
.grid {
  position: absolute;
  inset: 0;
  pointer-events: none;
  background-image:
    linear-gradient(
      to right,
      transparent calc(var(--cell) - 1px),
      var(--grid-bold) calc(var(--cell) - 1px)
    ),
    linear-gradient(
      to bottom,
      transparent calc(var(--cell) - 1px),
      var(--grid-bold) calc(var(--cell) - 1px)
    );
  background-size:
    var(--cell) var(--cell),
    var(--cell) var(--cell);
  background-color: var(--bg);
}

/* ---------------------------------------------
 * Layer Containers
 * ------------------------------------------- */
.tiles,
.tiles-preview,
.outlines,
.outlines-preview,
.tiles-user {
  position: absolute;
  inset: 0;
  pointer-events: none;
}

/* ---------------------------------------------
 * Tiles
 * ------------------------------------------- */
.tile {
  position: absolute;
  border-radius: 0;
  background: var(--paint-blue);
}

.tiles-preview .tile {
  opacity: 0.45;
}

/* ---------------------------------------------
 * Red Zone Tiles (light red, around castle and fortresses)
 * CSS-based rendering - each redzone block as a simple rectangle
 * ------------------------------------------- */
.tiles-redzone {
  position: absolute;
  inset: 0;
  pointer-events: none;
}

.redzone-rect {
  position: absolute;
  background: var(--paint-redzone);
}

/* ---------------------------------------------
 * Red Tiles (user toggle, dark red)
 * ------------------------------------------- */
.tile-red {
  position: absolute;
  border-radius: 0;
  background: var(--paint-red);
}

/* ---------------------------------------------
 * Outlines
 * ------------------------------------------- */
.area-outline {
  position: absolute;
  border: 2px dashed var(--paint-blue-border);
  border-radius: 0;
  background: transparent;
}

.outlines-preview .area-outline {
  opacity: 0.9;
}

/* ---------------------------------------------
 * Object Layer (polygon shapes below blocks)
 * ------------------------------------------- */
.object-layer {
  position: absolute;
  inset: 0;
  pointer-events: none;
  overflow: visible;
}

.object-layer path {
  pointer-events: fill;
  cursor: pointer;
}

.object-layer path:hover {
  filter: brightness(1.1);
}

.object-layer path.selected {
  stroke: var(--object-border);
  stroke-width: 3;
  stroke-dasharray: 5, 3;
}

/* Object layer labels */
.object-label {
  font-family: var(--font-family, sans-serif);
  font-size: 14px;
  font-weight: bold;
  fill: var(--object-label-color, #2d5a2d);
  pointer-events: none;
  user-select: none;
}

/* Object layer label editor */
.object-label-editor {
  position: absolute;
  /* Counter-rotate to match block label orientation inside rotated .rot */
  transform: translate(-50%, -50%) scaleY(-1) scaleX(-1) rotate(-45deg);
  transform-origin: center;
  min-width: 60px;
  max-width: 150px;
  padding: 4px 8px;
  font-family: var(--font-family, sans-serif);
  font-size: 14px;
  font-weight: bold;
  text-align: center;
  border: 2px solid var(--object-border, #3cb371);
  border-radius: 4px;
  background: white;
  color: #2d5a2d;
  outline: none;
  z-index: 200;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

.object-label-editor:focus {
  border-color: var(--object-control-bg, #4a90e2);
}

/* Control points for edge adjustment */
.object-control-point {
  position: absolute;
  width: 12px;
  height: 12px;
  background: var(--object-control-bg);
  border: 2px solid var(--object-control-border);
  border-radius: 50%;
  cursor: pointer;
  transform: translate(-50%, -50%);
  pointer-events: auto;
  z-index: 100;
  transition: transform 0.1s ease;
}

.object-control-point:hover {
  background: #2d6fd4;
  transform: translate(-50%, -50%) scale(1.3);
}

/* Step control points (between cells with different offsets) */
.object-control-point-step {
  background: var(--object-control-step-bg, #e4a04a);
  border-color: var(--object-control-step-border, #c4802a);
}

.object-control-point-step:hover {
  background: #d4902a;
}

/* Extension side control points (on sides of extended cells) */
.object-control-point-ext {
  background: var(--object-control-ext-bg, #7cb87c);
  border-color: var(--object-control-ext-border, #5a985a);
}

.object-control-point-ext:hover {
  background: #5a985a;
}
